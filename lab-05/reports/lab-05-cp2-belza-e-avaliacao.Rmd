---
title: "Laboratório 5 - Relação entre Beleza e Pontuação dos professores"
output: html_document
---

```{r warning=FALSE, echo=FALSE}
library(tidyverse)
library(broom)
library(modelr)
```
Vários cursos universitários dão aos alunos a oportunidade de avaliar o curso e o professor de maneira anônima ao final do semestre. Contudo, o uso das avaliações dos alunos como um indicador da qualidade do curso e a eficácia do ensino é frequentemente criticado porque essas medidas podem refletir a influência de características não relacionadas à docência, tal como a aparência física do professor. Neste laboratório analisaremos os dados de um estudo que coletou dados para examinar a hipótese de que a beleza do professor influencia na percepção de competência dos alunos.

Os dados foram coletados a partir das avaliações discentes de final de semestre de uma grande amostra de professores da Universidade do Texas em Austin. Além disso, seis estudantes avaliaram a aparência física dos professores. O resultado é um banco de dados no qual cada linha contém diferentes disciplinas e cada coluna representa as variáveis sobre as disciplinas e os professores. As variáveis contidas nele são as seguintes:

```
avaliacao_professores = read_csv(here::here("data/evals.csv"))
```

```{r read}
avaliacao_professores
```
Com base nos dados, é possível observar que existem 463 registros de avaliações de professores. Cada avaliação conta com 21 variáveis analisada, como por exemplo o score do professor, que apresenta a pontuação média do professor variando de 1 (muito insatisfeito) a 5 (excelente), gender (sexo do professor), age (idade do professor), bty_avg (média da beleza do professor, varia entre 0 a 10 sendo baseada nas variáveis  bty_f1lower, bty_f1upper, bty_f2upper, bty_m1lower, bty_m1upper e bty_m2upper, que representa a avaliação realizada por 6 alunos, no que diz respeito a beleza dos professores) e etc.

Essa análise manteve o foco principal em verificar o impacto das variáveis ank, ethnicity, gender, language, age, cls_*, pic_outfit e pic_color ..............

Na seção abaixo é apresentada os dados são explorados com mais detalhes.

##1. Análise descritiva dos dados

```{r}
avaliacao_professores %>% 
  group_by(gender) %>%
  summarise(
    total_number =  n()
  )
```

```{r}
avaliacao_professores %>% 
  group_by(ethnicity) %>%
  summarise(
    total_number =  n()
  )
```

```{r}
avaliacao_professores %>% 
  group_by(pic_outfit) %>%
  summarise(
    total_number =  n()
  )

avaliacao_professores %>% 
  group_by(pic_color) %>%
  summarise(
    total_number =  n()
  )

avaliacao_professores %>% 
  group_by(rank) %>%
  summarise(
    total_number =  n()
  )

avaliacao_professores %>% 
  group_by(cls_level) %>%
  summarise(
    total_number =  n()
  )
```

Primeiramente analisamos nos dados a distribuição dos scores dos professores. Para isso a Figura 1 foi produzida.

```{r}
avaliacao_professores %>% 
  ggplot(aes(x = score)) + 
  geom_histogram(bins = 20, fill = 'darkgreen') +
  labs(title="Figura 1 - Distribuição dos escores dos professores") 
```
De acordo com a Figura 1, é possível identificar que maior parte dos professores possuem o score médio entre 4.5  e 4.8 (mais de 70 professores). Além disso, é notável que existem poucos professores com scores médios entre os dois extremos da distribuição (em 0 ou 8).

Para analisar como está nos dados a distribuição da média da beleza dos professores a Figura 2 foi construída

```{r}
avaliacao_professores %>% 
  ggplot(aes(x = bty_avg)) + 
  geom_histogram(bins = 20, fill = 'darkgreen') +
  labs(title="Figura 2 - Distribuição da médias de beleza dos professores") 
```

Com base na Figura 2, é observado que maior parte dos professores possuem como média de beleza um balor 3 e 4.5 (4.3/4.4 maior concentração). No mais, podemos também analisar que não existem médias de belezas acima de 8.5 (médias possíveis são entre 0 a 10).


```{r}
avaliacao_professores %>% 
  ggplot(aes(x = age)) + 
  geom_histogram(bins = 20, fill = 'darkgreen') + 
  labs(title="Figura 3 - Distribuição das faixas etárias dos professores") 
```

```{r}
avaliacao_professores %>% 
  ggplot(aes(x = cls_students)) + 
  geom_histogram(bins = 24, fill = 'darkgreen') + 
  labs(title="Figura 4 - Distribuição do número de alunos das turmas dos professores") 
```

```{r}
avaliacao_professores %>% 
  ggplot(aes(x = cls_did_eval)) + 
  geom_histogram(bins = 20, fill = 'darkgreen') + 
  labs(title="Figura 5 - Número de alunos que responderam a avaliação do seu professor") 
```

##Média beleza e score professores

```{r}
modelo1 <- lm(score ~ bty_avg, data = avaliacao_professores)

tidy(modelo1, conf.int = TRUE, conf.level = 0.95)
glance(modelo1)

```

##idade e score professores

```{r}
modelo2 <- lm(score ~ rank, data = avaliacao_professores)

tidy(modelo2, conf.int = TRUE, conf.level = 0.95)
glance(modelo2)

```

